üöÄ ESP32-C3 Modbus RTU Master & Industrial Controller
[AHT20 | INA219 | NeoPixel | Samkoon HMI Slave Integration]
‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ESP32-C3 ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° (Master) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö 32-bit Floating Point ‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ Samkoon HMI ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ RS485 ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Relay ‡∏ö‡∏ô‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏£‡πå‡∏î
________________________________________
‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏î‡πà‡∏ô (Features)
‚Ä¢	Modbus Master Mode: ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ Modbus RTU (RS485) ‡∏ú‡πà‡∏≤‡∏ô GPIO 20, 21
‚Ä¢	High-Precision Sensors:
o	AHT20: ‡∏ß‡∏±‡∏î‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (%)
o	INA219: ‡∏ß‡∏±‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (V) ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (mA) ‡πÅ‡∏ö‡∏ö Real-time
‚Ä¢	32-bit Float Support: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á HMI ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Word Order (Low Word First)
‚Ä¢	NeoPixel Status LED:
o	üîµ Blue (Breathing): Standby / ‡∏õ‡∏Å‡∏ï‡∏¥
o	üü¢ Green (Flash): ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Success)
o	üî¥ Red (Flash): ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Error)
‚Ä¢	Bidirectional Control: ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏à‡∏≠ ‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå‡∏à‡∏≤‡∏Å‡∏à‡∏≠‡∏°‡∏≤‡∏Ñ‡∏∏‡∏° Relay ‡∏ö‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î
________________________________________
üìã Modbus Mapping (HMI Slave Side)
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ ESP32 Master ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏à‡∏≠ Samkoon ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Slave ID 1 ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Address ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
üîµ Numeric Display (LW - Local Word)
‡πÉ‡∏ä‡πâ Data Type: 32-bit Floating Point
Address	Parameter	Unit	Description
LW 100	Temperature	¬∞C	‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å AHT20
LW 102	Humidity	%	‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å AHT20
LW 104	Bus Voltage	V	‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å INA219
LW 106	Current	mA	‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å INA219
üü¢ Bit Logic (LB - Local Bit)
Address	Parameter	Function
LB 0	Input Status 1	‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏° GPIO 0
LB 1	Input Status 2	‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏° GPIO 1
LB 2	Remote Switch 1	(‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏à‡∏≠) ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Ñ‡∏∏‡∏° Relay 1 (GPIO 2)
LB 3	Remote Switch 2	(‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏à‡∏≠) ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Ñ‡∏∏‡∏° Relay 2 (GPIO 3)
________________________________________
üîå Hardware Configuration (‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ß‡∏á‡∏à‡∏£)
ESP32-C3 Pin	Function	Connection
GPIO 20	RX1	RS485 (RO)
GPIO 21	TX1	RS485 (DI)
GPIO 7	NeoPixel	WS2812B Data
GPIO 8 (SDA)	I2C Data	AHT20 / INA219
GPIO 9 (SCL)	I2C Clock	AHT20 / INA219
GPIO 0, 1	Digital Input	Push Buttons
GPIO 2, 3	Digital Output	Relay Module (Active LOW)
________________________________________
üñ•Ô∏è Samkoon SKTOOL 7.1 Setup
1.	Link Setup: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Modbus RTU Slave, Station No: 1, Baudrate: 9600, 8, N, 1
2.	Numeric Display: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Address ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Internal storage area -> LW
3.	Data Type: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 32-Bit Floating Point ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
4.	Word Swap: ‡∏´‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Word Swap ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Link Properties ‡∏Ç‡∏≠‡∏á SKTOOL
________________________________________
üì¶ Requirements
‚Ä¢	Library: ModbusMaster (by Doc Walker)
‚Ä¢	Library: Adafruit_AHTX0
‚Ä¢	Library: Adafruit_INA219
‚Ä¢	Library: Adafruit_NeoPixel
________________________________________
üöÄ Quick Start
1.	Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå .ino ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Arduino IDE
2.	‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Libraries ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ú‡πà‡∏≤‡∏ô Library Manager
3.	‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏õ‡πá‡∏ô ESP32-C3 Dev Module ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Upload
4.	‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Samkoon HMI (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Slave) ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

